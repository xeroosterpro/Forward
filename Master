WidgetMetadata = {
  id: "forward.tmdb",
  title: "TMDB Master Ultra",
  version: "6.0.0",
  requiredVersion: "0.0.1",
  description: "Ultimate TMDB discovery - 31 modules with USA Networks & Super Advanced filters",
  author: "Forward",
  site: "https://github.com/InchStudio/ForwardWidgets",
  modules: [
    { id: "quickPick", title: "ğŸ¬ Quick Pick Tonight", functionName: "quickPick", params: [
        { name: "mood", title: "Mood", type: "enumeration", enumOptions: [
          { title: "âš¡ Action", value: "action" }, { title: "ğŸ˜Š Feel-Good", value: "feelgood" }, { title: "ğŸ˜± Thriller", value: "thriller" },
          { title: "ğŸ˜‚ Comedy", value: "comedy" }, { title: "ğŸ¤¯ Mind-Bending", value: "mindbender" }, { title: "ğŸ’• Romance", value: "romance" },
          { title: "ğŸ‘» Horror", value: "horror" }, { title: "ğŸ—ºï¸ Adventure", value: "adventure" }]},
        { name: "time_available", title: "Time", type: "enumeration", enumOptions: [
          { title: "Quick (< 90 min)", value: "short" }, { title: "Standard (90-120)", value: "standard" },
          { title: "Long (120+)", value: "long" }, { title: "TV Episode", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "surpriseMe", title: "ğŸ² Surprise Me", functionName: "surpriseMe", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }, { title: "Random", value: "any" }]},
        { name: "quality", title: "Quality", type: "enumeration", enumOptions: [{ title: "Hidden Gems", value: "hidden" }, { title: "Highly Rated", value: "high" }, { title: "Any", value: "any" }]},
        { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "hotRightNow", title: "ğŸ”¥ Hot Right Now", functionName: "hotRightNow", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "hiddenGems", title: "ğŸ’ Hidden Gems", functionName: "hiddenGems", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "criticalDarlings", title: "ğŸ† Critical Darlings", functionName: "criticalDarlings", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "breakoutHits", title: "ğŸŒŸ Breakout Hits", functionName: "breakoutHits", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "familyMovieNight", title: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family Night", functionName: "familyMovieNight", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "lateNightPicks", title: "ğŸŒ™ Late Night", functionName: "lateNightPicks", params: [
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "epicSagas", title: "âš”ï¸ Epic Sagas", functionName: "epicSagas", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movies (150+ min)", value: "movie" }, { title: "Shows (3+ seasons)", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "shortAndSweet", title: "ğŸƒ Short & Sweet", functionName: "shortAndSweet", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movies (< 75 min)", value: "movie" }, { title: "Limited Series", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "indieDarlings", title: "ğŸ¨ Indie Darlings", functionName: "indieDarlings", params: [
        { name: "studio", title: "Type", type: "enumeration", enumOptions: [{ title: "A24 Films", value: "41077" }, { title: "All Indie", value: "indie" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "documentaryDeepDive", title: "ğŸ§  Documentaries", functionName: "documentaryDeepDive", params: [
        { name: "topic", title: "Topic", type: "enumeration", enumOptions: [{ title: "All", value: "all" }, { title: "Nature", value: "nature" },
          { title: "True Crime", value: "crime" }, { title: "History", value: "history" }, { title: "Science", value: "science" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "seasonalPicks", title: "ğŸƒ Seasonal", functionName: "seasonalPicks", params: [
        { name: "season", title: "Season", type: "enumeration", enumOptions: [{ title: "ğŸƒ Halloween", value: "halloween" },
          { title: "ğŸ„ Christmas", value: "christmas" }, { title: "â¤ï¸ Valentine's", value: "valentines" },
          { title: "â˜€ï¸ Summer", value: "summer" }, { title: "ğŸ‚ Fall", value: "fall" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "actorShowcase", title: "ğŸ­ Actor Showcase", functionName: "actorShowcase", params: [
        { name: "actor", title: "Actor", type: "enumeration", enumOptions: [{ title: "Tom Hanks", value: "31" }, { title: "Leonardo DiCaprio", value: "6193" },
          { title: "Meryl Streep", value: "5064" }, { title: "Denzel Washington", value: "5292" }, { title: "Scarlett Johansson", value: "1245" },
          { title: "Ryan Gosling", value: "30614" }, { title: "Margot Robbie", value: "234352" }, { title: "TimothÃ©e Chalamet", value: "1190668" },
          { title: "Zendaya", value: "505710" }, { title: "Florence Pugh", value: "1373737" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "directorSpotlight", title: "ğŸ¬ Director Spotlight", functionName: "directorSpotlight", params: [
        { name: "director", title: "Director", type: "enumeration", enumOptions: [{ title: "Christopher Nolan", value: "525" }, { title: "Quentin Tarantino", value: "138" },
          { title: "Steven Spielberg", value: "488" }, { title: "Martin Scorsese", value: "1032" }, { title: "Denis Villeneuve", value: "90059" },
          { title: "Wes Anderson", value: "5655" }, { title: "Greta Gerwig", value: "45400" }, { title: "Jordan Peele", value: "291263" },
          { title: "Bong Joon-ho", value: "21684" }, { title: "Guillermo del Toro", value: "490" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "usaNetworks", title: "ğŸ“º USA Networks", functionName: "usaNetworks", params: [
        { name: "with_networks", title: "Network", type: "enumeration", enumOptions: [
          { title: "â”â”â” Broadcast â”â”â”", value: "" },
          { title: "ABC", value: "2" }, { title: "NBC", value: "6" }, { title: "CBS", value: "16" }, { title: "FOX", value: "19" },
          { title: "The CW", value: "71" }, { title: "PBS", value: "14" },
          { title: "â”â”â” Premium Cable â”â”â”", value: "" },
          { title: "HBO", value: "49" }, { title: "Showtime", value: "67" }, { title: "Starz", value: "318" },
          { title: "Cinemax", value: "359" }, { title: "MGM+", value: "4330" },
          { title: "â”â”â” Entertainment â”â”â”", value: "" },
          { title: "AMC", value: "174" }, { title: "FX", value: "88" }, { title: "TNT", value: "41" },
          { title: "TBS", value: "68" }, { title: "USA Network", value: "30" }, { title: "Syfy", value: "77" },
          { title: "Bravo", value: "74" }, { title: "E!", value: "76" }, { title: "Lifetime", value: "34" },
          { title: "A&E", value: "129" }, { title: "Freeform", value: "1267" }, { title: "IFC", value: "630" },
          { title: "Paramount Network", value: "2076" }, { title: "Comedy Central", value: "47" },
          { title: "BET", value: "56" }, { title: "VH1", value: "158" }, { title: "MTV", value: "33" },
          { title: "â”â”â” Factual & Lifestyle â”â”â”", value: "" },
          { title: "Discovery Channel", value: "64" }, { title: "History", value: "65" },
          { title: "National Geographic", value: "43" }, { title: "Animal Planet", value: "91" },
          { title: "TLC", value: "80" }, { title: "Travel Channel", value: "82" },
          { title: "Food Network", value: "110" }, { title: "HGTV", value: "210" },
          { title: "â”â”â” Kids & Family â”â”â”", value: "" },
          { title: "Nickelodeon", value: "13" }, { title: "Cartoon Network", value: "56" },
          { title: "Disney Channel", value: "54" }, { title: "Disney XD", value: "44" },
          { title: "Disney Junior", value: "1193" },
          { title: "â”â”â” Sports â”â”â”", value: "" },
          { title: "ESPN", value: "29" }]},
        { name: "sort_by", title: "Sort By", type: "enumeration", enumOptions: [
          { title: "Popularity", value: "popularity.desc" }, { title: "Rating", value: "vote_average.desc" },
          { title: "First Air Date", value: "first_air_date.desc" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "superAdvanced", title: "ğŸ”¬ Super Advanced", functionName: "superAdvanced", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV Show", value: "tv" }]},
        { name: "year_from", title: "Year From", type: "input", value: "", description: "e.g., 2020" },
        { name: "year_to", title: "Year To", type: "input", value: "", description: "e.g., 2024" },
        { name: "min_rating", title: "Min Rating", type: "enumeration", enumOptions: [
          { title: "Any", value: "0" }, { title: "5.0+", value: "5" }, { title: "6.0+", value: "6" },
          { title: "7.0+", value: "7" }, { title: "7.5+", value: "7.5" }, { title: "8.0+", value: "8" }, { title: "8.5+", value: "8.5" }]},
        { name: "max_rating", title: "Max Rating", type: "enumeration", enumOptions: [
          { title: "Any", value: "10" }, { title: "9.0", value: "9" }, { title: "8.5", value: "8.5" },
          { title: "8.0", value: "8" }, { title: "7.5", value: "7.5" }, { title: "7.0", value: "7" }]},
        { name: "min_votes", title: "Min Votes", type: "enumeration", enumOptions: [
          { title: "Any", value: "0" }, { title: "50+", value: "50" }, { title: "100+", value: "100" },
          { title: "200+", value: "200" }, { title: "500+", value: "500" }, { title: "1000+", value: "1000" }, { title: "2000+", value: "2000" }]},
        { name: "max_votes", title: "Max Votes (Hidden Gems)", type: "enumeration", enumOptions: [
          { title: "Any", value: "999999" }, { title: "5000", value: "5000" }, { title: "2000", value: "2000" },
          { title: "1000", value: "1000" }, { title: "500", value: "500" }]},
        { name: "runtime_min", title: "Min Runtime (Movies)", type: "enumeration", enumOptions: [
          { title: "Any", value: "0" }, { title: "30 min", value: "30" }, { title: "60 min", value: "60" },
          { title: "90 min", value: "90" }, { title: "120 min", value: "120" }, { title: "150 min", value: "150" }]},
        { name: "runtime_max", title: "Max Runtime (Movies)", type: "enumeration", enumOptions: [
          { title: "Any", value: "300" }, { title: "180 min", value: "180" }, { title: "150 min", value: "150" },
          { title: "120 min", value: "120" }, { title: "90 min", value: "90" }, { title: "75 min", value: "75" }]},
        { name: "with_genres", title: "Include Genres", type: "input", value: "", description: "Genre IDs comma separated" },
        { name: "without_genres", title: "Exclude Genres", type: "input", value: "", description: "Genre IDs comma separated" },
        { name: "with_keywords", title: "With Keywords", type: "input", value: "", description: "Keyword IDs comma separated" },
        { name: "without_keywords", title: "Without Keywords", type: "input", value: "", description: "Keyword IDs comma separated" },
        { name: "with_companies", title: "Production Company", type: "input", value: "", description: "Company IDs comma separated" },
        { name: "with_networks", title: "Network (TV)", type: "input", value: "", description: "Network IDs comma separated" },
        { name: "certification", title: "Rating", type: "enumeration", enumOptions: [
          { title: "Any", value: "" }, { title: "G", value: "G" }, { title: "PG", value: "PG" },
          { title: "PG-13", value: "PG-13" }, { title: "R", value: "R" }, { title: "NC-17", value: "NC-17" },
          { title: "TV-Y", value: "TV-Y" }, { title: "TV-Y7", value: "TV-Y7" }, { title: "TV-G", value: "TV-G" },
          { title: "TV-PG", value: "TV-PG" }, { title: "TV-14", value: "TV-14" }, { title: "TV-MA", value: "TV-MA" }]},
        { name: "with_original_language", title: "Original Language", type: "enumeration", enumOptions: [
          { title: "Any", value: "" }, { title: "English", value: "en" }, { title: "Spanish", value: "es" },
          { title: "French", value: "fr" }, { title: "German", value: "de" }, { title: "Japanese", value: "ja" },
          { title: "Korean", value: "ko" }, { title: "Chinese", value: "zh" }, { title: "Italian", value: "it" },
          { title: "Hindi", value: "hi" }, { title: "Portuguese", value: "pt" }, { title: "Russian", value: "ru" }]},
        { name: "sort_by", title: "Sort By", type: "enumeration", enumOptions: [
          { title: "Popularity â†“", value: "popularity.desc" }, { title: "Popularity â†‘", value: "popularity.asc" },
          { title: "Rating â†“", value: "vote_average.desc" }, { title: "Rating â†‘", value: "vote_average.asc" },
          { title: "Votes â†“", value: "vote_count.desc" }, { title: "Votes â†‘", value: "vote_count.asc" },
          { title: "Release Date â†“", value: "release_date.desc" }, { title: "Release Date â†‘", value: "release_date.asc" },
          { title: "Revenue â†“", value: "revenue.desc" }, { title: "Title A-Z", value: "original_title.asc" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "nowPlaying", title: "Now Playing", functionName: "nowPlaying", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "trending", title: "Trending", functionName: "trending", params: [
        { name: "time_window", title: "Window", type: "enumeration", enumOptions: [{ title: "Today", value: "day" }, { title: "This Week", value: "week" }]},
        { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "popular", title: "Popular", functionName: "popular", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "topRated", title: "Top Rated", functionName: "topRated", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "bingeWorthy", title: "ğŸ“º Binge-Worthy", functionName: "bingeWorthy", params: [
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "discover", title: "Smart Discover", functionName: "discover", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "year", title: "Year", type: "input", value: "", description: "e.g., 2024" },
        { name: "min_rating", title: "Min Rating", type: "enumeration", enumOptions: [{ title: "Any", value: "0" }, { title: "5.0+", value: "5" },
          { title: "6.0+", value: "6" }, { title: "7.0+", value: "7" }, { title: "8.0+", value: "8" }]},
        { name: "runtime", title: "Runtime", type: "enumeration", enumOptions: [{ title: "Any", value: "any" }, { title: "Short (< 90)", value: "short" },
          { title: "Standard (90-120)", value: "standard" }, { title: "Long (120-150)", value: "long" }, { title: "Epic (150+)", value: "epic" }]},
        { name: "sort_by", title: "Sort", type: "enumeration", enumOptions: [{ title: "Popularity", value: "popularity.desc" },
          { title: "Rating", value: "vote_average.desc" }, { title: "Votes", value: "vote_count.desc" }, { title: "Release Date", value: "release_date.desc" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "upcoming", title: "Coming Soon", functionName: "upcoming", params: [
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "timeframe", title: "When", type: "enumeration", enumOptions: [{ title: "Just Released (30d)", value: "recent" }, { title: "Coming Soon", value: "upcoming" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "decadeExplorer", title: "ğŸ•°ï¸ Decade Explorer", functionName: "decadeExplorer", params: [
        { name: "decade", title: "Decade", type: "enumeration", enumOptions: [{ title: "2020s", value: "2020" }, { title: "2010s", value: "2010" },
          { title: "2000s", value: "2000" }, { title: "1990s", value: "1990" }, { title: "1980s", value: "1980" }, { title: "1970s", value: "1970" },
          { title: "1960s", value: "1960" }, { title: "1950s", value: "1950" }]},
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "languageExplorer", title: "ğŸŒ Language Explorer", functionName: "languageExplorer", params: [
        { name: "original_language", title: "Language", type: "enumeration", enumOptions: [{ title: "Korean", value: "ko" },
          { title: "Japanese", value: "ja" }, { title: "Spanish", value: "es" }, { title: "French", value: "fr" }, { title: "German", value: "de" },
          { title: "Italian", value: "it" }, { title: "Hindi", value: "hi" }, { title: "Chinese", value: "zh" }, { title: "Portuguese", value: "pt" },
          { title: "Russian", value: "ru" }, { title: "Arabic", value: "ar" }, { title: "Turkish", value: "tr" }, { title: "Thai", value: "th" }]},
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "genres", title: "Browse by Genre", functionName: "genres", params: [
        { name: "genre", title: "Genre", type: "enumeration", enumOptions: [{ title: "Action", value: "28" }, { title: "Adventure", value: "12" },
          { title: "Animation", value: "16" }, { title: "Comedy", value: "35" }, { title: "Crime", value: "80" }, { title: "Documentary", value: "99" },
          { title: "Drama", value: "18" }, { title: "Family", value: "10751" }, { title: "Fantasy", value: "14" }, { title: "History", value: "36" },
          { title: "Horror", value: "27" }, { title: "Music", value: "10402" }, { title: "Mystery", value: "9648" }, { title: "Romance", value: "10749" },
          { title: "Sci-Fi", value: "878" }, { title: "Thriller", value: "53" }, { title: "War", value: "10752" }, { title: "Western", value: "37" }]},
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "sort_by", title: "Sort", type: "enumeration", enumOptions: [{ title: "Popularity", value: "popularity.desc" },
          { title: "Rating", value: "vote_average.desc" }, { title: "Release Date", value: "release_date.desc" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "networks", title: "Streaming", functionName: "networks", params: [
        { name: "with_networks", title: "Network", type: "enumeration", enumOptions: [{ title: "Netflix", value: "213" }, { title: "Disney+", value: "2739" },
          { title: "Apple TV+", value: "2552" }, { title: "Max", value: "3186" }, { title: "Hulu", value: "453" }, { title: "Prime Video", value: "1024" },
          { title: "Paramount+", value: "4330" }, { title: "Peacock", value: "3353" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "companies", title: "Companies", functionName: "companies", params: [
        { name: "with_companies", title: "Company", type: "enumeration", enumOptions: [{ title: "Disney", value: "2" }, { title: "Warner Bros", value: "174" },
          { title: "Marvel", value: "420" }, { title: "Pixar", value: "3" }, { title: "A24", value: "41077" }, { title: "Blumhouse", value: "3172" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "certifications", title: "By Rating", functionName: "certifications", params: [
        { name: "certification", title: "Rating", type: "enumeration", enumOptions: [{ title: "G", value: "G" }, { title: "PG", value: "PG" },
          { title: "PG-13", value: "PG-13" }, { title: "R", value: "R" }, { title: "TV-Y7", value: "TV-Y7" }, { title: "TV-PG", value: "TV-PG" },
          { title: "TV-14", value: "TV-14" }, { title: "TV-MA", value: "TV-MA" }]},
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]},
    { id: "keywords", title: "By Theme", functionName: "keywords", params: [
        { name: "keyword", title: "Theme", type: "enumeration", enumOptions: [{ title: "Superhero", value: "9715" }, { title: "Time Travel", value: "4379" },
          { title: "Space", value: "9882" }, { title: "Zombie", value: "12377" }, { title: "AI", value: "9951" }, { title: "Dystopia", value: "10683" },
          { title: "Heist", value: "6149" }, { title: "Coming of Age", value: "9840" }]},
        { name: "type", title: "Type", type: "enumeration", enumOptions: [{ title: "Movie", value: "movie" }, { title: "TV", value: "tv" }]},
        { name: "page", title: "Page", type: "page" }, { name: "language", title: "Language", type: "language", value: "en-US" }]}
  ]
};

// Base function to fetch TMDB data
async function fetchData(api, params, forceMediaType) {
  try {
    const response = await Widget.tmdb.get(api, { params: params });
    if (!response) {
      throw new Error("Failed to fetch data");
    }
    const data = response.results;
    const result = data.map((item) => {
      let mediaType = item.media_type;
      if (forceMediaType) {
        mediaType = forceMediaType;
      } else if (mediaType == null) {
        if (item.title) {
          mediaType = "movie";
        } else {
          mediaType = "tv";
        }
      }
      return {
        id: item.id,
        type: "tmdb",
        title: item.title ?? item.name,
        description: item.overview,
        releaseDate: item.release_date ?? item.first_air_date,
        backdropPath: item.backdrop_path,
        posterPath: item.poster_path,
        rating: item.vote_average,
        mediaType: mediaType,
        genreTitle: genreTitleWith(item.genre_ids),
      };
    });
    return result;
  } catch (error) {
    console.error("Failed to call TMDB API:", error);
    throw error;
  }
}

async function nowPlaying(params) {
  const type = params.type;
  let api = "tv/on_the_air";
  if (type === "movie") {
    api = "movie/now_playing";
  }
  return await fetchData(api, params, type);
}

async function trending(params) {
  const timeWindow = params.time_window;
  const api = `trending/all/${timeWindow}`;
  delete params.time_window;
  return await fetchData(api, params);
}

async function popular(params) {
  const type = params.type;
  let api = `movie/popular`;
  if (type === "tv") {
    api = `tv/popular`;
  }
  delete params.type;
  return await fetchData(api, params, type);
}

async function topRated(params) {
  const type = params.type;
  let api = `movie/top_rated`;
  if (type === "tv") {
    api = `tv/top_rated`;
  }
  delete params.type;
  return await fetchData(api, params, type);
}

// NEW: Comprehensive genre browser
async function genres(params) {
  const genreId = params.genre;
  const type = params.type;
  const sortBy = params.sort_by || "popularity.desc";

  const api = `discover/${type}`;
  const queryParams = {
    with_genres: genreId,
    sort_by: sortBy,
    page: params.page,
    language: params.language,
    vote_count_gte: 10, // Filter out obscure titles
  };

  return await fetchData(api, queryParams, type);
}


async function networks(params) {
  let api = `discover/tv`;
  delete params.type;
  return await fetchData(api, params, "tv");
}

async function companies(params) {
  let api = `discover/movie`;
  delete params.type;
  return await fetchData(api, params, "movie");
}

// NEW: Browse by certification/rating
async function certifications(params) {
  const certification = params.certification;
  const type = params.type;

  const api = `discover/${type}`;
  const queryParams = {
    certification_country: "US",
    certification: certification,
    sort_by: "popularity.desc",
    page: params.page,
    language: params.language,
  };

  return await fetchData(api, queryParams, type);
}

// NEW: Browse by keyword/theme
async function keywords(params) {
  const keywordId = params.keyword;
  const type = params.type;

  const api = `discover/${type}`;
  const queryParams = {
    with_keywords: keywordId,
    sort_by: "popularity.desc",
    page: params.page,
    language: params.language,
  };

  return await fetchData(api, queryParams, type);
}

// NEW: Movie collections


// FIXED: MDBList using proper API

function genreTitleWith(genre_ids) {
  if (!genre_ids) {
    return "";
  }
  const genreDict = [
    {"id": 10759, "name": "Action & Adventure"},
    {"id": 16, "name": "Animation"},
    {"id": 35, "name": "Comedy"},
    {"id": 80, "name": "Crime"},
    {"id": 99, "name": "Documentary"},
    {"id": 18, "name": "Drama"},
    {"id": 10751, "name": "Family"},
    {"id": 10762, "name": "Kids"},
    {"id": 9648, "name": "Mystery"},
    {"id": 10763, "name": "News"},
    {"id": 10764, "name": "Reality"},
    {"id": 10765, "name": "Sci-Fi & Fantasy"},
    {"id": 10766, "name": "Soap"},
    {"id": 10767, "name": "Talk"},
    {"id": 10768, "name": "War & Politics"},
    {"id": 37, "name": "Western"},
    {"id": 28, "name": "Action"},
    {"id": 12, "name": "Adventure"},
    {"id": 14, "name": "Fantasy"},
    {"id": 36, "name": "History"},
    {"id": 27, "name": "Horror"},
    {"id": 10402, "name": "Music"},
    {"id": 10749, "name": "Romance"},
    {"id": 878, "name": "Science Fiction"},
    {"id": 10770, "name": "TV Movie"},
    {"id": 53, "name": "Thriller"},
    {"id": 10752, "name": "War"},
  ];
  if (genre_ids.length > 2) {
    genre_ids = genre_ids.slice(0, 2);
  }
  const result = genre_ids.map(id => {
    const genre = genreDict.find(genre => genre.id == id);
    if (genre) {
      return genre.name;
    }
    return null;
  }).filter(genre => genre !== null).join(", ");
  return result;
}
